"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.validateFromFile = exports.validate = void 0;

var _jsYaml = _interopRequireDefault(require("js-yaml"));

var _fs = _interopRequireDefault(require("fs"));

var _traverse = _interopRequireDefault(require("./traverse"));

var _validators = _interopRequireDefault(require("./validators"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

const validate = (yamlData, filePath, options) => {
  let document;

  try {
    document = _jsYaml.default.safeLoad(yamlData);
  } catch (ex) {
    throw new Error("Can't load yaml file");
  }

  if (!document.openapi) return [];
  const result = (0, _traverse.default)(document, _validators.default, yamlData, filePath, options);
  return result;
};

exports.validate = validate;

const validateFromFile = (fName, options) => {
  const resolvedFileName = fName; // path.resolve(fName);

  const doc = _fs.default.readFileSync(resolvedFileName, 'utf-8');

  const validationResult = validate(doc, resolvedFileName, options);
  return validationResult;
};

exports.validateFromFile = validateFromFile;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy92YWxpZGF0ZS5qcyJdLCJuYW1lcyI6WyJ2YWxpZGF0ZSIsInlhbWxEYXRhIiwiZmlsZVBhdGgiLCJvcHRpb25zIiwiZG9jdW1lbnQiLCJ5YW1sIiwic2FmZUxvYWQiLCJleCIsIkVycm9yIiwib3BlbmFwaSIsInJlc3VsdCIsIk9wZW5BUElSb290IiwidmFsaWRhdGVGcm9tRmlsZSIsImZOYW1lIiwicmVzb2x2ZWRGaWxlTmFtZSIsImRvYyIsImZzIiwicmVhZEZpbGVTeW5jIiwidmFsaWRhdGlvblJlc3VsdCJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFBOztBQUNBOztBQUVBOztBQUNBOzs7O0FBRU8sTUFBTUEsUUFBUSxHQUFHLENBQUNDLFFBQUQsRUFBV0MsUUFBWCxFQUFxQkMsT0FBckIsS0FBaUM7QUFDdkQsTUFBSUMsUUFBSjs7QUFDQSxNQUFJO0FBQ0ZBLElBQUFBLFFBQVEsR0FBR0MsZ0JBQUtDLFFBQUwsQ0FBY0wsUUFBZCxDQUFYO0FBQ0QsR0FGRCxDQUVFLE9BQU9NLEVBQVAsRUFBVztBQUNYLFVBQU0sSUFBSUMsS0FBSixDQUFVLHNCQUFWLENBQU47QUFDRDs7QUFDRCxNQUFJLENBQUNKLFFBQVEsQ0FBQ0ssT0FBZCxFQUF1QixPQUFPLEVBQVA7QUFDdkIsUUFBTUMsTUFBTSxHQUFHLHVCQUFTTixRQUFULEVBQW1CTyxtQkFBbkIsRUFBZ0NWLFFBQWhDLEVBQTBDQyxRQUExQyxFQUFvREMsT0FBcEQsQ0FBZjtBQUNBLFNBQU9PLE1BQVA7QUFDRCxDQVZNOzs7O0FBWUEsTUFBTUUsZ0JBQWdCLEdBQUcsQ0FBQ0MsS0FBRCxFQUFRVixPQUFSLEtBQW9CO0FBQ2xELFFBQU1XLGdCQUFnQixHQUFHRCxLQUF6QixDQURrRCxDQUNsQjs7QUFDaEMsUUFBTUUsR0FBRyxHQUFHQyxZQUFHQyxZQUFILENBQWdCSCxnQkFBaEIsRUFBa0MsT0FBbEMsQ0FBWjs7QUFDQSxRQUFNSSxnQkFBZ0IsR0FBR2xCLFFBQVEsQ0FBQ2UsR0FBRCxFQUFNRCxnQkFBTixFQUF3QlgsT0FBeEIsQ0FBakM7QUFDQSxTQUFPZSxnQkFBUDtBQUNELENBTE0iLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeWFtbCBmcm9tICdqcy15YW1sJztcbmltcG9ydCBmcyBmcm9tICdmcyc7XG5cbmltcG9ydCB0cmF2ZXJzZSBmcm9tICcuL3RyYXZlcnNlJztcbmltcG9ydCBPcGVuQVBJUm9vdCBmcm9tICcuL3ZhbGlkYXRvcnMnO1xuXG5leHBvcnQgY29uc3QgdmFsaWRhdGUgPSAoeWFtbERhdGEsIGZpbGVQYXRoLCBvcHRpb25zKSA9PiB7XG4gIGxldCBkb2N1bWVudDtcbiAgdHJ5IHtcbiAgICBkb2N1bWVudCA9IHlhbWwuc2FmZUxvYWQoeWFtbERhdGEpO1xuICB9IGNhdGNoIChleCkge1xuICAgIHRocm93IG5ldyBFcnJvcihcIkNhbid0IGxvYWQgeWFtbCBmaWxlXCIpO1xuICB9XG4gIGlmICghZG9jdW1lbnQub3BlbmFwaSkgcmV0dXJuIFtdO1xuICBjb25zdCByZXN1bHQgPSB0cmF2ZXJzZShkb2N1bWVudCwgT3BlbkFQSVJvb3QsIHlhbWxEYXRhLCBmaWxlUGF0aCwgb3B0aW9ucyk7XG4gIHJldHVybiByZXN1bHQ7XG59O1xuXG5leHBvcnQgY29uc3QgdmFsaWRhdGVGcm9tRmlsZSA9IChmTmFtZSwgb3B0aW9ucykgPT4ge1xuICBjb25zdCByZXNvbHZlZEZpbGVOYW1lID0gZk5hbWU7IC8vIHBhdGgucmVzb2x2ZShmTmFtZSk7XG4gIGNvbnN0IGRvYyA9IGZzLnJlYWRGaWxlU3luYyhyZXNvbHZlZEZpbGVOYW1lLCAndXRmLTgnKTtcbiAgY29uc3QgdmFsaWRhdGlvblJlc3VsdCA9IHZhbGlkYXRlKGRvYywgcmVzb2x2ZWRGaWxlTmFtZSwgb3B0aW9ucyk7XG4gIHJldHVybiB2YWxpZGF0aW9uUmVzdWx0O1xufTtcbiJdfQ==