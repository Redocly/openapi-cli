"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _yaml = require("./yaml");

const prettyPrintError = error => {
  const message = `${error.location.startLine}:${error.location.startCol}` + ' Following error occured:\n' + `${error.message} by path ${error.path}\n` + `${error.pathStack.length ? `path stack is ${error.pathStack}` : ''}\n` + `${error.codeFrame}`;
  return message;
};

const createError = (msg, node, ctx) => {
  const location = (0, _yaml.getLocationByPath)(Array.from(ctx.path), ctx);
  const body = {
    message: msg,
    path: ctx.path.join('/'),
    pathStack: ctx.pathStack.map(el => el.join('/')),
    location,
    codeFrame: (0, _yaml.getCodeFrameForLocation)(location.startIndex, location.endIndex, ctx.source),
    value: node,
    severity: 'ERROR'
  };
  return { ...body,
    prettyPrint: () => prettyPrintError(body)
  };
};

var _default = createError;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9lcnJvci5qcyJdLCJuYW1lcyI6WyJwcmV0dHlQcmludEVycm9yIiwiZXJyb3IiLCJtZXNzYWdlIiwibG9jYXRpb24iLCJzdGFydExpbmUiLCJzdGFydENvbCIsInBhdGgiLCJwYXRoU3RhY2siLCJsZW5ndGgiLCJjb2RlRnJhbWUiLCJjcmVhdGVFcnJvciIsIm1zZyIsIm5vZGUiLCJjdHgiLCJBcnJheSIsImZyb20iLCJib2R5Iiwiam9pbiIsIm1hcCIsImVsIiwic3RhcnRJbmRleCIsImVuZEluZGV4Iiwic291cmNlIiwidmFsdWUiLCJzZXZlcml0eSIsInByZXR0eVByaW50Il0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7O0FBRUEsTUFBTUEsZ0JBQWdCLEdBQUlDLEtBQUQsSUFBVztBQUNsQyxRQUFNQyxPQUFPLEdBQUksR0FBRUQsS0FBSyxDQUFDRSxRQUFOLENBQWVDLFNBQVUsSUFBR0gsS0FBSyxDQUFDRSxRQUFOLENBQWVFLFFBQVMsRUFBdkQsR0FDZCw2QkFEYyxHQUViLEdBQUVKLEtBQUssQ0FBQ0MsT0FBUSxZQUFXRCxLQUFLLENBQUNLLElBQUssSUFGekIsR0FHYixHQUFFTCxLQUFLLENBQUNNLFNBQU4sQ0FBZ0JDLE1BQWhCLEdBQTBCLGlCQUFnQlAsS0FBSyxDQUFDTSxTQUFVLEVBQTFELEdBQThELEVBQUcsSUFIdEQsR0FJYixHQUFFTixLQUFLLENBQUNRLFNBQVUsRUFKckI7QUFLQSxTQUFPUCxPQUFQO0FBQ0QsQ0FQRDs7QUFTQSxNQUFNUSxXQUFXLEdBQUcsQ0FBQ0MsR0FBRCxFQUFNQyxJQUFOLEVBQVlDLEdBQVosS0FBb0I7QUFDdEMsUUFBTVYsUUFBUSxHQUFHLDZCQUFrQlcsS0FBSyxDQUFDQyxJQUFOLENBQVdGLEdBQUcsQ0FBQ1AsSUFBZixDQUFsQixFQUF3Q08sR0FBeEMsQ0FBakI7QUFDQSxRQUFNRyxJQUFJLEdBQUc7QUFDWGQsSUFBQUEsT0FBTyxFQUFFUyxHQURFO0FBRVhMLElBQUFBLElBQUksRUFBRU8sR0FBRyxDQUFDUCxJQUFKLENBQVNXLElBQVQsQ0FBYyxHQUFkLENBRks7QUFHWFYsSUFBQUEsU0FBUyxFQUFFTSxHQUFHLENBQUNOLFNBQUosQ0FBY1csR0FBZCxDQUFtQkMsRUFBRCxJQUFRQSxFQUFFLENBQUNGLElBQUgsQ0FBUSxHQUFSLENBQTFCLENBSEE7QUFJWGQsSUFBQUEsUUFKVztBQUtYTSxJQUFBQSxTQUFTLEVBQUUsbUNBQXdCTixRQUFRLENBQUNpQixVQUFqQyxFQUE2Q2pCLFFBQVEsQ0FBQ2tCLFFBQXRELEVBQWdFUixHQUFHLENBQUNTLE1BQXBFLENBTEE7QUFNWEMsSUFBQUEsS0FBSyxFQUFFWCxJQU5JO0FBT1hZLElBQUFBLFFBQVEsRUFBRTtBQVBDLEdBQWI7QUFTQSxTQUFPLEVBQ0wsR0FBR1IsSUFERTtBQUVMUyxJQUFBQSxXQUFXLEVBQUUsTUFBTXpCLGdCQUFnQixDQUFDZ0IsSUFBRDtBQUY5QixHQUFQO0FBSUQsQ0FmRDs7ZUFpQmVOLFciLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBnZXRMb2NhdGlvbkJ5UGF0aCwgZ2V0Q29kZUZyYW1lRm9yTG9jYXRpb24gfSBmcm9tICcuL3lhbWwnO1xuXG5jb25zdCBwcmV0dHlQcmludEVycm9yID0gKGVycm9yKSA9PiB7XG4gIGNvbnN0IG1lc3NhZ2UgPSBgJHtlcnJvci5sb2NhdGlvbi5zdGFydExpbmV9OiR7ZXJyb3IubG9jYXRpb24uc3RhcnRDb2x9YFxuICArICcgRm9sbG93aW5nIGVycm9yIG9jY3VyZWQ6XFxuJ1xuICArIGAke2Vycm9yLm1lc3NhZ2V9IGJ5IHBhdGggJHtlcnJvci5wYXRofVxcbmBcbiAgKyBgJHtlcnJvci5wYXRoU3RhY2subGVuZ3RoID8gYHBhdGggc3RhY2sgaXMgJHtlcnJvci5wYXRoU3RhY2t9YCA6ICcnfVxcbmBcbiAgKyBgJHtlcnJvci5jb2RlRnJhbWV9YDtcbiAgcmV0dXJuIG1lc3NhZ2U7XG59O1xuXG5jb25zdCBjcmVhdGVFcnJvciA9IChtc2csIG5vZGUsIGN0eCkgPT4ge1xuICBjb25zdCBsb2NhdGlvbiA9IGdldExvY2F0aW9uQnlQYXRoKEFycmF5LmZyb20oY3R4LnBhdGgpLCBjdHgpO1xuICBjb25zdCBib2R5ID0ge1xuICAgIG1lc3NhZ2U6IG1zZyxcbiAgICBwYXRoOiBjdHgucGF0aC5qb2luKCcvJyksXG4gICAgcGF0aFN0YWNrOiBjdHgucGF0aFN0YWNrLm1hcCgoZWwpID0+IGVsLmpvaW4oJy8nKSksXG4gICAgbG9jYXRpb24sXG4gICAgY29kZUZyYW1lOiBnZXRDb2RlRnJhbWVGb3JMb2NhdGlvbihsb2NhdGlvbi5zdGFydEluZGV4LCBsb2NhdGlvbi5lbmRJbmRleCwgY3R4LnNvdXJjZSksXG4gICAgdmFsdWU6IG5vZGUsXG4gICAgc2V2ZXJpdHk6ICdFUlJPUicsXG4gIH07XG4gIHJldHVybiB7XG4gICAgLi4uYm9keSxcbiAgICBwcmV0dHlQcmludDogKCkgPT4gcHJldHR5UHJpbnRFcnJvcihib2R5KSxcbiAgfTtcbn07XG5cbmV4cG9ydCBkZWZhdWx0IGNyZWF0ZUVycm9yO1xuIl19