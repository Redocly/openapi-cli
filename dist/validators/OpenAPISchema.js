"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _error = _interopRequireDefault(require("../error"));

var _OpenAPIExternalDocumentation = _interopRequireDefault(require("./OpenAPIExternalDocumentation"));

var _OpenAPISchemaMap = _interopRequireDefault(require("./OpenAPISchemaMap"));

var _OpenAPIDiscriminator = _interopRequireDefault(require("./OpenAPIDiscriminator"));

var _OpenAPIXML = _interopRequireDefault(require("./OpenAPIXML"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

/* eslint-disable import/no-cycle */
const OpenAPISchemaObject = {
  validators: {
    title() {
      return (node, ctx) => {
        if (node && node.title) {
          if (!(typeof node.title === 'string')) return (0, _error.default)('Title of the schema must be a string', node, ctx);
        }

        return null;
      };
    },

    multipleOf() {
      return (node, ctx) => {
        if (node && node.multipleOf) {
          if (typeof node.multipleOf !== 'number') return (0, _error.default)('Value of multipleOf must be a number', node, ctx);
          if (node.multipleOf < 0) return (0, _error.default)('Value of multipleOf must be greater or equal to zero', node, ctx);
        }

        return null;
      };
    },

    maximum() {
      return (node, ctx) => {
        if (node && node.maximum && typeof node.maximum !== 'number') return (0, _error.default)('Value of maximum must be a number', node, ctx);
        return null;
      };
    },

    exclusiveMaximum() {
      return (node, ctx) => {
        if (node && node.exclusiveMaximum && typeof node.exclusiveMaximum !== 'boolean') return (0, _error.default)('Value of exclusiveMaximum must be a boolean', node, ctx);
        return null;
      };
    },

    minimum() {
      return (node, ctx) => {
        if (node && node.minimum && typeof node.minimum !== 'number') return (0, _error.default)('Value of minimum must be a number', node, ctx);
        return null;
      };
    },

    exclusiveMinimum() {
      return (node, ctx) => {
        if (node && node.exclusiveMinimum && typeof node.exclusiveMinimum !== 'boolean') return (0, _error.default)('Value of exclusiveMinimum must be a boolean', node, ctx);
        return null;
      };
    },

    maxLength() {
      return (node, ctx) => {
        if (node && node.maxLength) {
          if (typeof node.maxLength !== 'number') return (0, _error.default)('Value of maxLength must be a number', node, ctx);
          if (node.maxLength < 0) return (0, _error.default)('Value of maxLength must be greater or equal to zero', node, ctx);
        }

        return null;
      };
    },

    minLength() {
      return (node, ctx) => {
        if (node && node.minLength) {
          if (typeof node.minLength !== 'number') return (0, _error.default)('Value of minLength must be a number', node, ctx);
          if (node.minLength < 0) return (0, _error.default)('Value of minLength must be greater or equal to zero', node, ctx);
        }

        return null;
      };
    },

    pattern() {
      return (node, ctx) => {
        if (node && node.pattern) {
          // TODO: add regexp validation.
          if (typeof node.pattern !== 'string') return (0, _error.default)('Value of pattern must be a string', node, ctx);
        }

        return null;
      };
    },

    maxItems() {
      return (node, ctx) => {
        if (node && node.maxItems) {
          if (typeof node.maxItems !== 'number') return (0, _error.default)('Value of maxItems must be a number', node, ctx);
          if (node.maxItems < 0) return (0, _error.default)('Value of maxItems must be greater or equal to zero. You can`t have negative amount of something.', node, ctx);
        }

        return null;
      };
    },

    minItems() {
      return (node, ctx) => {
        if (node && node.minItems) {
          if (typeof node.minItems !== 'number') return (0, _error.default)('Value of minItems must be a number', node, ctx);
          if (node.minItems < 0) return (0, _error.default)('Value of minItems must be greater or equal to zero. You can`t have negative amount of something.', node, ctx);
        }

        return null;
      };
    },

    uniqueItems() {
      return (node, ctx) => {
        if (node && node.uniqueItems) {
          if (typeof node.uniqueItems !== 'boolean') return (0, _error.default)('Value of uniqueItems must be a boolean', node, ctx);
        }

        return null;
      };
    },

    maxProperties() {
      return (node, ctx) => {
        if (node && node.maxProperties) {
          if (typeof node.maxProperties !== 'number') return (0, _error.default)('Value of maxProperties must be a number', node, ctx);
          if (node.maxProperties < 0) return (0, _error.default)('Value of maxProperties must be greater or equal to zero. You can`t have negative amount of something.', node, ctx);
        }

        return null;
      };
    },

    minProperties() {
      return (node, ctx) => {
        if (node && node.minProperties) {
          if (typeof node.minProperties !== 'number') return (0, _error.default)('Value of minProperties must be a number', node, ctx);
          if (node.minProperties < 0) return (0, _error.default)('Value of minProperties must be greater or equal to zero. You can`t have negative amount of something.', node, ctx);
        }

        return null;
      };
    },

    required() {
      return (node, ctx) => {
        if (node && node.required) {
          if (!Array.isArray(node.required)) return (0, _error.default)('Value of required must be an array', node, ctx);
          if (node.required.filter(item => typeof item !== 'string').length !== 0) return (0, _error.default)('All values of "required" field must be strings', node, ctx);
        }

        return null;
      };
    },

    enum() {
      return (node, ctx) => {
        if (node && node.enum) {
          if (!Array.isArray(node.enum)) return (0, _error.default)('Value of enum must be an array', node, ctx);

          if (node.type && typeof node.type === 'string' // eslint-disable-next-line valid-typeof
          && node.enum.filter(item => typeof item !== node.type).length !== 0) {
            return (0, _error.default)('All values of "enum" field must be of the same type as the "type" field', node, ctx);
          }
        }

        return null;
      };
    },

    type() {
      return (node, ctx) => {
        if (node.type && !['string', 'object', 'array', 'integer', 'number', 'boolean'].includes(node.type)) {
          return (0, _error.default)('Object type can be one of following only: "string", "object", "array", "integer", "number", "boolean"', node, ctx);
        }

        return null;
      };
    },

    items() {
      return (node, ctx) => {
        if (node && node.items && Array.isArray(node.items)) return (0, _error.default)('Value of items must not be an array. It must be a Schema object', node, ctx);
        return null;
      };
    },

    additionalProperties() {
      return () => null;
    },

    description() {
      return (node, ctx) => {
        if (node && node.description && typeof node.description !== 'string') return (0, _error.default)('Value of description must be a string', node, ctx);
        return null;
      };
    },

    format() {
      return (node, ctx) => {
        if (node && node.format && typeof node.format !== 'string') return (0, _error.default)('Value of format must be a string', node, ctx);
        return null;
      };
    },

    nullable() {
      return (node, ctx) => {
        if (node && node.nullable && typeof node.nullable !== 'boolean') return (0, _error.default)('Value of nullable must be a boolean', node, ctx);
        return null;
      };
    },

    readOnly() {
      return (node, ctx) => {
        if (node && node.readOnly && typeof node.readOnly !== 'boolean') return (0, _error.default)('Value of readOnly must be a boolean', node, ctx);
        return null;
      };
    },

    writeOnly() {
      return (node, ctx) => {
        if (node && node.writeOnly && typeof node.writeOnly !== 'boolean') return (0, _error.default)('Value of writeOnly must be a boolean', node, ctx);
        return null;
      };
    },

    deprecated() {
      return (node, ctx) => {
        if (node && node.deprecated && typeof node.deprecated !== 'boolean') return (0, _error.default)('Value of deprecated must be a boolean', node, ctx);
        return null;
      };
    },

    example() {
      return () => null;
    },

    default() {
      return () => null;
    }

  },
  properties: {
    allOf() {
      return OpenAPISchemaObject;
    },

    anyOf() {
      return OpenAPISchemaObject;
    },

    oneOf() {
      return OpenAPISchemaObject;
    },

    not() {
      return OpenAPISchemaObject;
    },

    items() {
      return OpenAPISchemaObject;
    },

    properties: _OpenAPISchemaMap.default,
    discriminator: _OpenAPIDiscriminator.default,
    externalDocs: _OpenAPIExternalDocumentation.default,
    xml: _OpenAPIXML.default
  }
};
var _default = OpenAPISchemaObject;
exports.default = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy92YWxpZGF0b3JzL09wZW5BUElTY2hlbWEuanMiXSwibmFtZXMiOlsiT3BlbkFQSVNjaGVtYU9iamVjdCIsInZhbGlkYXRvcnMiLCJ0aXRsZSIsIm5vZGUiLCJjdHgiLCJtdWx0aXBsZU9mIiwibWF4aW11bSIsImV4Y2x1c2l2ZU1heGltdW0iLCJtaW5pbXVtIiwiZXhjbHVzaXZlTWluaW11bSIsIm1heExlbmd0aCIsIm1pbkxlbmd0aCIsInBhdHRlcm4iLCJtYXhJdGVtcyIsIm1pbkl0ZW1zIiwidW5pcXVlSXRlbXMiLCJtYXhQcm9wZXJ0aWVzIiwibWluUHJvcGVydGllcyIsInJlcXVpcmVkIiwiQXJyYXkiLCJpc0FycmF5IiwiZmlsdGVyIiwiaXRlbSIsImxlbmd0aCIsImVudW0iLCJ0eXBlIiwiaW5jbHVkZXMiLCJpdGVtcyIsImFkZGl0aW9uYWxQcm9wZXJ0aWVzIiwiZGVzY3JpcHRpb24iLCJmb3JtYXQiLCJudWxsYWJsZSIsInJlYWRPbmx5Iiwid3JpdGVPbmx5IiwiZGVwcmVjYXRlZCIsImV4YW1wbGUiLCJkZWZhdWx0IiwicHJvcGVydGllcyIsImFsbE9mIiwiYW55T2YiLCJvbmVPZiIsIm5vdCIsIk9wZW5BUElTY2hlbWFNYXAiLCJkaXNjcmltaW5hdG9yIiwiT3BlbkFQSURpc2NyaW1pbmF0b3IiLCJleHRlcm5hbERvY3MiLCJPcGVuQVBJRXh0ZXJuYWxEb2N1bWVudGF0aW9uIiwieG1sIiwiT3BlbkFQSVhNTCJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUNBOztBQUVBOztBQUNBOztBQUNBOztBQUNBOzs7O0FBTkE7QUFRQSxNQUFNQSxtQkFBbUIsR0FBRztBQUMxQkMsRUFBQUEsVUFBVSxFQUFFO0FBQ1ZDLElBQUFBLEtBQUssR0FBRztBQUNOLGFBQU8sQ0FBQ0MsSUFBRCxFQUFPQyxHQUFQLEtBQWU7QUFDcEIsWUFBSUQsSUFBSSxJQUFJQSxJQUFJLENBQUNELEtBQWpCLEVBQXdCO0FBQ3RCLGNBQUksRUFBRSxPQUFPQyxJ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QVA7QUFDRCxLQU5TOztBQU9Wd0MsSUFBQUEsS0FBSyxHQUFHO0FBQ04sYUFBT3hDLG1CQUFQO0FBQ0QsS0FUUzs7QUFVVnlDLElBQUFBLEdBQUcsR0FBRztBQUNKLGFBQU96QyxtQkFBUDtBQUNELEtBWlM7O0FBYVYyQixJQUFBQSxLQUFLLEdBQUc7QUFDTixhQUFPM0IsbUJBQVA7QUFDRCxLQWZTOztBQWdCVnFDLElBQUFBLFVBQVUsRUFBRUsseUJBaEJGO0FBaUJWQyxJQUFBQSxhQUFhLEVBQUVDLDZCQWpCTDtBQWtCVkMsSUFBQUEsWUFBWSxFQUFFQyxxQ0FsQko7QUFtQlZDLElBQUFBLEdBQUcsRUFBRUM7QUFuQks7QUFyTWMsQ0FBNUI7ZUE0TmVoRCxtQiIsInNvdXJjZXNDb250ZW50IjpbIi8qIGVzbGludC1kaXNhYmxlIGltcG9ydC9uby1jeWNsZSAqL1xuaW1wb3J0IGNyZWF0ZUVycm9yIGZyb20gJy4uL2Vycm9yJztcblxuaW1wb3J0IE9wZW5BUElFeHRlcm5hbERvY3VtZW50YXRpb24gZnJvbSAnLi9PcGVuQVBJRXh0ZXJuYWxEb2N1bWVudGF0aW9uJztcbmltcG9ydCBPcGVuQVBJU2NoZW1hTWFwIGZyb20gJy4vT3BlbkFQSVNjaGVtYU1hcCc7XG5pbXBvcnQgT3BlbkFQSURpc2NyaW1pbmF0b3IgZnJvbSAnLi9PcGVuQVBJRGlzY3JpbWluYXRvcic7XG5pbXBvcnQgT3BlbkFQSVhNTCBmcm9tICcuL09wZW5BUElYTUwnO1xuXG5jb25zdCBPcGVuQVBJU2NoZW1hT2JqZWN0ID0ge1xuICB2YWxpZGF0b3JzOiB7XG4gICAgdGl0bGUoKSB7XG4gICAgICByZXR1cm4gKG5vZGUsIGN0eCkgPT4ge1xuICAgICAgICBpZiAobm9kZSAmJiBub2RlLnRpdGxlKSB7XG4gICAgICAgICAgaWYgKCEodHlwZW9mIG5vZGUudGl0bGUgPT09ICdzdHJpbmcnKSkgcmV0dXJuIGNyZWF0ZUVycm9yKCdUaXRsZSBvZiB0aGUgc2NoZW1hIG11c3QgYmUgYSBzdHJpbmcnLCBub2RlLCBjdHgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfTtcbiAgICB9LFxuICAgIG11bHRpcGxlT2YoKSB7XG4gICAgICByZXR1cm4gKG5vZGUsIGN0eCkgPT4ge1xuICAgICAgICBpZiAobm9kZSAmJiBub2RlLm11bHRpcGxlT2YpIHtcbiAgICAgICAgICBpZiAodHlwZW9mIG5vZGUubXVsdGlwbGVPZiAhPT0gJ251bWJlcicpIHJldHVybiBjcmVhdGVFcnJvcignVmFsdWUgb2YgbXVsdGlwbGVPZiBtdXN0IGJlIGEgbnVtYmVyJywgbm9kZSwgY3R4KTtcbiAgICAgICAgICBpZiAobm9kZS5tdWx0aXBsZU9mIDwgMCkgcmV0dXJuIGNyZWF0ZUVycm9yKCdWYWx1ZSBvZiBtdWx0aXBsZU9mIG11c3QgYmUgZ3JlYXRlciBvciBlcXVhbCB0byB6ZXJvJywgbm9kZSwgY3R4KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH07XG4gICAgfSxcbiAgICBtYXhpbXVtKCkge1xuICAgICAgcmV0dXJuIChub2RlLCBjdHgpID0+IHtcbiAgICAgICAgaWYgKG5vZGUgJiYgbm9kZS5tYXhpbXVtICYmIHR5cGVvZiBub2RlLm1heGltdW0gIT09ICdudW1iZXInKSByZXR1cm4gY3JlYXRlRXJyb3IoJ1ZhbHVlIG9mIG1heGltdW0gbXVzdCBiZSBhIG51bWJlcicsIG5vZGUsIGN0eCk7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfTtcbiAgICB9LFxuICAgIGV4Y2x1c2l2ZU1heGltdW0oKSB7XG4gICAgICByZXR1cm4gKG5vZGUsIGN0eCkgPT4ge1xuICAgICAgICBpZiAobm9kZSAmJiBub2RlLmV4Y2x1c2l2ZU1heGltdW0gJiYgdHlwZW9mIG5vZGUuZXhjbHVzaXZlTWF4aW11bSAhPT0gJ2Jvb2xlYW4nKSByZXR1cm4gY3JlYXRlRXJyb3IoJ1ZhbHVlIG9mIGV4Y2x1c2l2ZU1heGltdW0gbXVzdCBiZSBhIGJvb2xlYW4nLCBub2RlLCBjdHgpO1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH07XG4gICAgfSxcbiAgICBtaW5pbXVtKCkge1xuICAgICAgcmV0dXJuIChub2RlLCBjdHgpID0+IHtcbiAgICAgICAgaWYgKG5vZGUgJiYgbm9kZS5taW5pbXVtICYmIHR5cGVvZiBub2RlLm1pbmltdW0gIT09ICdudW1iZXInKSByZXR1cm4gY3JlYXRlRXJyb3IoJ1ZhbHVlIG9mIG1pbmltdW0gbXVzdCBiZSBhIG51bWJlcicsIG5vZGUsIGN0eCk7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfTtcbiAgICB9LFxuICAgIGV4Y2x1c2l2ZU1pbmltdW0oKSB7XG4gICAgICByZXR1cm4gKG5vZGUsIGN0eCkgPT4ge1xuICAgICAgICBpZiAobm9kZSAmJiBub2RlLmV4Y2x1c2l2ZU1pbmltdW0gJiYgdHlwZW9mIG5vZGUuZXhjbHVzaXZlTWluaW11bSAhPT0gJ2Jvb2xlYW4nKSByZXR1cm4gY3JlYXRlRXJyb3IoJ1ZhbHVlIG9mIGV4Y2x1c2l2ZU1pbmltdW0gbXVzdCBiZSBhIGJvb2xlYW4nLCBub2RlLCBjdHgpO1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH07XG4gICAgfSxcbiAgICBtYXhMZW5ndGgoKSB7XG4gICAgICByZXR1cm4gKG5vZGUsIGN0eCkgPT4ge1xuICAgICAgICBpZiAobm9kZSAmJiBub2RlLm1heExlbmd0aCkge1xuICAgICAgICAgIGlmICh0eXBlb2Ygbm9kZS5tYXhMZW5ndGggIT09ICdudW1iZXInKSByZXR1cm4gY3JlYXRlRXJyb3IoJ1ZhbHVlIG9mIG1heExlbmd0aCBtdXN0IGJlIGEgbnVtYmVyJywgbm9kZSwgY3R4KTtcbiAgICAgICAgICBpZiAobm9kZS5tYXhMZW5ndGggPCAwKSByZXR1cm4gY3JlYXRlRXJyb3IoJ1ZhbHVlIG9mIG1heExlbmd0aCBtdXN0IGJlIGdyZWF0ZXIgb3IgZXF1YWwgdG8gemVybycsIG5vZGUsIGN0eCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9O1xuICAgIH0sXG4gICAgbWluTGVuZ3RoKCkge1xuICAgICAgcmV0dXJuIChub2RlLCBjdHgpID0+IHtcbiAgICAgICAgaWYgKG5vZGUgJiYgbm9kZS5taW5MZW5ndGgpIHtcbiAgICAgICAgICBpZiAodHlwZW9mIG5vZGUubWluTGVuZ3RoICE9PSAnbnVtYmVyJykgcmV0dXJuIGNyZWF0ZUVycm9yKCdWYWx1ZSBvZiBtaW5MZW5ndGggbXVzdCBiZSBhIG51bWJlcicsIG5vZGUsIGN0eCk7XG4gICAgICAgICAgaWYgKG5vZGUubWluTGVuZ3RoIDwgMCkgcmV0dXJuIGNyZWF0ZUVycm9yKCdWYWx1ZSBvZiBtaW5MZW5ndGggbXVzdCBiZSBncmVhdGVyIG9yIGVxdWFsIHRvIHplcm8nLCBub2RlLCBjdHgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfTtcbiAgICB9LFxuICAgIHBhdHRlcm4oKSB7XG4gICAgICByZXR1cm4gKG5vZGUsIGN0eCkgPT4ge1xuICAgICAgICBpZiAobm9kZSAmJiBub2RlLnBhdHRlcm4pIHtcbiAgICAgICAgICAvLyBUT0RPOiBhZGQgcmVnZXhwIHZhbGlkYXRpb24uXG4gICAgICAgICAgaWYgKHR5cGVvZiBub2RlLnBhdHRlcm4gIT09ICdzdHJpbmcnKSByZXR1cm4gY3JlYXRlRXJyb3IoJ1ZhbHVlIG9mIHBhdHRlcm4gbXVzdCBiZSBhIHN0cmluZycsIG5vZGUsIGN0eCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9O1xuICAgIH0sXG4gICAgbWF4SXRlbXMoKSB7XG4gICAgICByZXR1cm4gKG5vZGUsIGN0eCkgPT4ge1xuICAgICAgICBpZiAobm9kZSAmJiBub2RlLm1heEl0ZW1zKSB7XG4gICAgICAgICAgaWYgKHR5cGVvZiBub2RlLm1heEl0ZW1zICE9PSAnbnVtYmVyJykgcmV0dXJuIGNyZWF0ZUVycm9yKCdWYWx1ZSBvZiBtYXhJdGVtcyBtdXN0IGJlIGEgbnVtYmVyJywgbm9kZSwgY3R4KTtcbiAgICAgICAgICBpZiAobm9kZS5tYXhJdGVtcyA8IDApIHJldHVybiBjcmVhdGVFcnJvcignVmFsdWUgb2YgbWF4SXRlbXMgbXVzdCBiZSBncmVhdGVyIG9yIGVxdWFsIHRvIHplcm8uIFlvdSBjYW5gdCBoYXZlIG5lZ2F0aXZlIGFtb3VudCBvZiBzb21ldGhpbmcuJywgbm9kZSwgY3R4KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH07XG4gICAgfSxcbiAgICBtaW5JdGVtcygpIHtcbiAgICAgIHJldHVybiAobm9kZSwgY3R4KSA9PiB7XG4gICAgICAgIGlmIChub2RlICYmIG5vZGUubWluSXRlbXMpIHtcbiAgICAgICAgICBpZiAodHlwZW9mIG5vZGUubWluSXRlbXMgIT09ICdudW1iZXInKSByZXR1cm4gY3JlYXRlRXJyb3IoJ1ZhbHVlIG9mIG1pbkl0ZW1zIG11c3QgYmUgYSBudW1iZXInLCBub2RlLCBjdHgpO1xuICAgICAgICAgIGlmIChub2RlLm1pbkl0ZW1zIDwgMCkgcmV0dXJuIGNyZWF0ZUVycm9yKCdWYWx1ZSBvZiBtaW5JdGVtcyBtdXN0IGJlIGdyZWF0ZXIgb3IgZXF1YWwgdG8gemVyby4gWW91IGNhbmB0IGhhdmUgbmVnYXRpdmUgYW1vdW50IG9mIHNvbWV0aGluZy4nLCBub2RlLCBjdHgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfTtcbiAgICB9LFxuICAgIHVuaXF1ZUl0ZW1zKCkge1xuICAgICAgcmV0dXJuIChub2RlLCBjdHgpID0+IHtcbiAgICAgICAgaWYgKG5vZGUgJiYgbm9kZS51bmlxdWVJdGVtcykge1xuICAgICAgICAgIGlmICh0eXBlb2Ygbm9kZS51bmlxdWVJdGVtcyAhPT0gJ2Jvb2xlYW4nKSByZXR1cm4gY3JlYXRlRXJyb3IoJ1ZhbHVlIG9mIHVuaXF1ZUl0ZW1zIG11c3QgYmUgYSBib29sZWFuJywgbm9kZSwgY3R4KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH07XG4gICAgfSxcbiAgICBtYXhQcm9wZXJ0aWVzKCkge1xuICAgICAgcmV0dXJuIChub2RlLCBjdHgpID0+IHtcbiAgICAgICAgaWYgKG5vZGUgJiYgbm9kZS5tYXhQcm9wZXJ0aWVzKSB7XG4gICAgICAgICAgaWYgKHR5cGVvZiBub2RlLm1heFByb3BlcnRpZXMgIT09ICdudW1iZXInKSByZXR1cm4gY3JlYXRlRXJyb3IoJ1ZhbHVlIG9mIG1heFByb3BlcnRpZXMgbXVzdCBiZSBhIG51bWJlcicsIG5vZGUsIGN0eCk7XG4gICAgICAgICAgaWYgKG5vZGUubWF4UHJvcGVydGllcyA8IDApIHJldHVybiBjcmVhdGVFcnJvcignVmFsdWUgb2YgbWF4UHJvcGVydGllcyBtdXN0IGJlIGdyZWF0ZXIgb3IgZXF1YWwgdG8gemVyby4gWW91IGNhbmB0IGhhdmUgbmVnYXRpdmUgYW1vdW50IG9mIHNvbWV0aGluZy4nLCBub2RlLCBjdHgpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfTtcbiAgICB9LFxuICAgIG1pblByb3BlcnRpZXMoKSB7XG4gICAgICByZXR1cm4gKG5vZGUsIGN0eCkgPT4ge1xuICAgICAgICBpZiAobm9kZSAmJiBub2RlLm1pblByb3BlcnRpZXMpIHtcbiAgICAgICAgICBpZiAodHlwZW9mIG5vZGUubWluUHJvcGVydGllcyAhPT0gJ251bWJlcicpIHJldHVybiBjcmVhdGVFcnJvcignVmFsdWUgb2YgbWluUHJvcGVydGllcyBtdXN0IGJlIGEgbnVtYmVyJywgbm9kZSwgY3R4KTtcbiAgICAgICAgICBpZiAobm9kZS5taW5Qcm9wZXJ0aWVzIDwgMCkgcmV0dXJuIGNyZWF0ZUVycm9yKCdWYWx1ZSBvZiBtaW5Qcm9wZXJ0aWVzIG11c3QgYmUgZ3JlYXRlciBvciBlcXVhbCB0byB6ZXJvLiBZb3UgY2FuYHQgaGF2ZSBuZWdhdGl2ZSBhbW91bnQgb2Ygc29tZXRoaW5nLicsIG5vZGUsIGN0eCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9O1xuICAgIH0sXG4gICAgcmVxdWlyZWQoKSB7XG4gICAgICByZXR1cm4gKG5vZGUsIGN0eCkgPT4ge1xuICAgICAgICBpZiAobm9kZSAmJiBub2RlLnJlcXVpcmVkKSB7XG4gICAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KG5vZGUucmVxdWlyZWQpKSByZXR1cm4gY3JlYXRlRXJyb3IoJ1ZhbHVlIG9mIHJlcXVpcmVkIG11c3QgYmUgYW4gYXJyYXknLCBub2RlLCBjdHgpO1xuICAgICAgICAgIGlmIChub2RlLnJlcXVpcmVkLmZpbHRlcigoaXRlbSkgPT4gdHlwZW9mIGl0ZW0gIT09ICdzdHJpbmcnKS5sZW5ndGggIT09IDApIHJldHVybiBjcmVhdGVFcnJvcignQWxsIHZhbHVlcyBvZiBcInJlcXVpcmVkXCIgZmllbGQgbXVzdCBiZSBzdHJpbmdzJywgbm9kZSwgY3R4KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH07XG4gICAgfSxcbiAgICBlbnVtKCkge1xuICAgICAgcmV0dXJuIChub2RlLCBjdHgpID0+IHtcbiAgICAgICAgaWYgKG5vZGUgJiYgbm9kZS5lbnVtKSB7XG4gICAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KG5vZGUuZW51bSkpIHJldHVybiBjcmVhdGVFcnJvcignVmFsdWUgb2YgZW51bSBtdXN0IGJlIGFuIGFycmF5Jywgbm9kZSwgY3R4KTtcbiAgICAgICAgICBpZiAobm9kZS50eXBlXG4gICAgICAgICAgICAgICYmIHR5cGVvZiBub2RlLnR5cGUgPT09ICdzdHJpbmcnXG4gICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSB2YWxpZC10eXBlb2ZcbiAgICAgICAgICAgICAgJiYgbm9kZS5lbnVtLmZpbHRlcigoaXRlbSkgPT4gdHlwZW9mIGl0ZW0gIT09IG5vZGUudHlwZSkubGVuZ3RoICE9PSAwKSB7XG4gICAgICAgICAgICByZXR1cm4gY3JlYXRlRXJyb3IoJ0FsbCB2YWx1ZXMgb2YgXCJlbnVtXCIgZmllbGQgbXVzdCBiZSBvZiB0aGUgc2FtZSB0eXBlIGFzIHRoZSBcInR5cGVcIiBmaWVsZCcsIG5vZGUsIGN0eCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfTtcbiAgICB9LFxuICAgIHR5cGUoKSB7XG4gICAgICByZXR1cm4gKG5vZGUsIGN0eCkgPT4ge1xuICAgICAgICBpZiAobm9kZS50eXBlICYmICFbJ3N0cmluZycsICdvYmplY3QnLCAnYXJyYXknLCAnaW50ZWdlcicsICdudW1iZXInLCAnYm9vbGVhbiddLmluY2x1ZGVzKG5vZGUudHlwZSkpIHtcbiAgICAgICAgICByZXR1cm4gY3JlYXRlRXJyb3IoJ09iamVjdCB0eXBlIGNhbiBiZSBvbmUgb2YgZm9sbG93aW5nIG9ubHk6IFwic3RyaW5nXCIsIFwib2JqZWN0XCIsIFwiYXJyYXlcIiwgXCJpbnRlZ2VyXCIsIFwibnVtYmVyXCIsIFwiYm9vbGVhblwiJywgbm9kZSwgY3R4KTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH07XG4gICAgfSxcbiAgICBpdGVtcygpIHtcbiAgICAgIHJldHVybiAobm9kZSwgY3R4KSA9PiB7XG4gICAgICAgIGlmIChub2RlICYmIG5vZGUuaXRlbXMgJiYgQXJyYXkuaXNBcnJheShub2RlLml0ZW1zKSkgcmV0dXJuIGNyZWF0ZUVycm9yKCdWYWx1ZSBvZiBpdGVtcyBtdXN0IG5vdCBiZSBhbiBhcnJheS4gSXQgbXVzdCBiZSBhIFNjaGVtYSBvYmplY3QnLCBub2RlLCBjdHgpO1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH07XG4gICAgfSxcbiAgICBhZGRpdGlvbmFsUHJvcGVydGllcygpIHtcbiAgICAgIHJldHVybiAoKSA9PiBudWxsO1xuICAgIH0sXG4gICAgZGVzY3JpcHRpb24oKSB7XG4gICAgICByZXR1cm4gKG5vZGUsIGN0eCkgPT4ge1xuICAgICAgICBpZiAobm9kZSAmJiBub2RlLmRlc2NyaXB0aW9uICYmIHR5cGVvZiBub2RlLmRlc2NyaXB0aW9uICE9PSAnc3RyaW5nJykgcmV0dXJuIGNyZWF0ZUVycm9yKCdWYWx1ZSBvZiBkZXNjcmlwdGlvbiBtdXN0IGJlIGEgc3RyaW5nJywgbm9kZSwgY3R4KTtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9O1xuICAgIH0sXG4gICAgZm9ybWF0KCkge1xuICAgICAgcmV0dXJuIChub2RlLCBjdHgpID0+IHtcbiAgICAgICAgaWYgKG5vZGUgJiYgbm9kZS5mb3JtYXQgJiYgdHlwZW9mIG5vZGUuZm9ybWF0ICE9PSAnc3RyaW5nJykgcmV0dXJuIGNyZWF0ZUVycm9yKCdWYWx1ZSBvZiBmb3JtYXQgbXVzdCBiZSBhIHN0cmluZycsIG5vZGUsIGN0eCk7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfTtcbiAgICB9LFxuICAgIG51bGxhYmxlKCkge1xuICAgICAgcmV0dXJuIChub2RlLCBjdHgpID0+IHtcbiAgICAgICAgaWYgKG5vZGUgJiYgbm9kZS5udWxsYWJsZSAmJiB0eXBlb2Ygbm9kZS5udWxsYWJsZSAhPT0gJ2Jvb2xlYW4nKSByZXR1cm4gY3JlYXRlRXJyb3IoJ1ZhbHVlIG9mIG51bGxhYmxlIG11c3QgYmUgYSBib29sZWFuJywgbm9kZSwgY3R4KTtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9O1xuICAgIH0sXG4gICAgcmVhZE9ubHkoKSB7XG4gICAgICByZXR1cm4gKG5vZGUsIGN0eCkgPT4ge1xuICAgICAgICBpZiAobm9kZSAmJiBub2RlLnJlYWRPbmx5ICYmIHR5cGVvZiBub2RlLnJlYWRPbmx5ICE9PSAnYm9vbGVhbicpIHJldHVybiBjcmVhdGVFcnJvcignVmFsdWUgb2YgcmVhZE9ubHkgbXVzdCBiZSBhIGJvb2xlYW4nLCBub2RlLCBjdHgpO1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH07XG4gICAgfSxcbiAgICB3cml0ZU9ubHkoKSB7XG4gICAgICByZXR1cm4gKG5vZGUsIGN0eCkgPT4ge1xuICAgICAgICBpZiAobm9kZSAmJiBub2RlLndyaXRlT25seSAmJiB0eXBlb2Ygbm9kZS53cml0ZU9ubHkgIT09ICdib29sZWFuJykgcmV0dXJuIGNyZWF0ZUVycm9yKCdWYWx1ZSBvZiB3cml0ZU9ubHkgbXVzdCBiZSBhIGJvb2xlYW4nLCBub2RlLCBjdHgpO1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH07XG4gICAgfSxcbiAgICBkZXByZWNhdGVkKCkge1xuICAgICAgcmV0dXJuIChub2RlLCBjdHgpID0+IHtcbiAgICAgICAgaWYgKG5vZGUgJiYgbm9kZS5kZXByZWNhdGVkICYmIHR5cGVvZiBub2RlLmRlcHJlY2F0ZWQgIT09ICdib29sZWFuJykgcmV0dXJuIGNyZWF0ZUVycm9yKCdWYWx1ZSBvZiBkZXByZWNhdGVkIG11c3QgYmUgYSBib29sZWFuJywgbm9kZSwgY3R4KTtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9O1xuICAgIH0sXG4gICAgZXhhbXBsZSgpIHtcbiAgICAgIHJldHVybiAoKSA9PiBudWxsO1xuICAgIH0sXG4gICAgZGVmYXVsdCgpIHtcbiAgICAgIHJldHVybiAoKSA9PiBudWxsO1xuICAgIH0sXG4gIH0sXG4gIHByb3BlcnRpZXM6IHtcbiAgICBhbGxPZigpIHtcbiAgICAgIHJldHVybiBPcGVuQVBJU2NoZW1hT2JqZWN0O1xuICAgIH0sXG4gICAgYW55T2YoKSB7XG4gICAgICByZXR1cm4gT3BlbkFQSVNjaGVtYU9iamVjdDtcbiAgICB9LFxuICAgIG9uZU9mKCkge1xuICAgICAgcmV0dXJuIE9wZW5BUElTY2hlbWFPYmplY3Q7XG4gICAgfSxcbiAgICBub3QoKSB7XG4gICAgICByZXR1cm4gT3BlbkFQSVNjaGVtYU9iamVjdDtcbiAgICB9LFxuICAgIGl0ZW1zKCkge1xuICAgICAgcmV0dXJuIE9wZW5BUElTY2hlbWFPYmplY3Q7XG4gICAgfSxcbiAgICBwcm9wZXJ0aWVzOiBPcGVuQVBJU2NoZW1hTWFwLFxuICAgIGRpc2NyaW1pbmF0b3I6IE9wZW5BUElEaXNjcmltaW5hdG9yLFxuICAgIGV4dGVybmFsRG9jczogT3BlbkFQSUV4dGVybmFsRG9jdW1lbnRhdGlvbixcbiAgICB4bWw6IE9wZW5BUElYTUwsXG4gIH0sXG59O1xuXG5leHBvcnQgZGVmYXVsdCBPcGVuQVBJU2NoZW1hT2JqZWN0O1xuIl19